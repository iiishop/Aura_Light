<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura Light Dashboard V2.0</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>

<body>
    <div class="container">

        <header class="dashboard-header">
            <h1>Aura Light Control Panel</h1>
            <div class="connection-status" id="connectionStatus">
                <span class="status-indicator" id="statusIndicator"></span>
                <span id="statusText">Disconnected</span>
            </div>
        </header>


        <div class="dashboard-grid">


            <div class="column">


                <section class="card connection-card">
                    <h2>MQTT Connection</h2>
                    <div class="form-group">
                        <label>Username: <strong>ucfninn</strong></label>
                        <input type="hidden" id="username" value="ucfninn">
                    </div>
                    <button id="connectBtn" class="btn btn-primary">Connect</button>
                    <button id="disconnectBtn" class="btn btn-secondary" disabled>Disconnect</button>
                </section>


                <section class="card control-card">
                    <h2>Light Status</h2>
                    <div class="status-display">
                        <div class="status-badge" id="lightStatus">OFF</div>
                    </div>
                    <div class="button-group">
                        <button id="turnOnBtn" class="btn btn-success" disabled>Turn ON</button>
                        <button id="turnOffBtn" class="btn btn-danger" disabled>Turn OFF</button>
                    </div>
                </section>


                <section class="card controller-card">
                    <h2>Controller</h2>
                    <div class="controller-display">
                        <div class="controller-badge" id="currentController">LOCAL</div>
                    </div>
                    <div class="controller-buttons">
                        <button class="controller-btn active" data-controller="local" disabled>
                            <span>Local (8 LEDs)</span>
                        </button>
                        <button class="controller-btn" data-controller="luminaire" disabled>
                            <span>Luminaire (72 LEDs)</span>
                        </button>
                    </div>
                </section>


                <section class="card mode-card">
                    <h2>Light Mode</h2>
                    <div class="mode-display">
                        <div class="mode-badge" id="currentMode">IDLE</div>
                    </div>
                    <div class="mode-buttons">
                        <button class="mode-btn mode-timer" data-mode="timer" disabled>
                            <span class="mode-icon">‚è±Ô∏è</span>
                            <span>Timer</span>
                        </button>
                        <button class="mode-btn mode-weather" data-mode="weather" disabled>
                            <span class="mode-icon">üå§Ô∏è</span>
                            <span>Weather</span>
                        </button>
                        <button class="mode-btn mode-idle" data-mode="idle" disabled>
                            <span class="mode-icon">üí§</span>
                            <span>Idle</span>
                        </button>
                        <button class="mode-btn mode-music" data-mode="music" disabled>
                            <span class="mode-icon">üéµ</span>
                            <span>Music</span>
                        </button>
                    </div>
                </section>

            </div>


            <div class="column">


                <section class="card weather-card">
                    <h2>Weather</h2>
                    <div class="weather-display">
                        <div class="weather-icon" id="weatherIcon">
                            <div class="weather-loading">Loading...</div>
                        </div>
                        <div class="weather-temp">
                            <span class="temp-value" id="tempValue">--</span>
                            <span class="temp-unit">¬∞C</span>
                        </div>
                        <div class="weather-desc" id="weatherDesc">--</div>
                        <div class="weather-location" id="weatherLocation">--</div>
                    </div>
                    <div class="weather-details">
                        <div class="weather-detail-item">
                            <div class="detail-label">Humidity</div>
                            <div class="detail-value" id="humidity">--%</div>
                        </div>
                        <div class="weather-detail-item">
                            <div class="detail-label">Wind</div>
                            <div class="detail-value" id="windSpeed">-- km/h</div>
                        </div>
                        <div class="weather-detail-item">
                            <div class="detail-label">Visibility</div>
                            <div class="detail-value" id="visibility">-- km</div>
                        </div>
                        <div class="weather-detail-item">
                            <div class="detail-label">Feels Like</div>
                            <div class="detail-value" id="feelsLike">--¬∞C</div>
                        </div>
                    </div>
                </section>

            </div>


            <div class="column">


                <section class="card info-card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h2 style="margin: 0;">System Information</h2>
                        <button id="refreshInfoBtn" class="btn btn-sm" disabled>Refresh INFO</button>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">WiFi SSID:</span>
                            <span class="info-value" id="infoWifiSSID">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">IP Address:</span>
                            <span class="info-value" id="infoWifiIP">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Signal (RSSI):</span>
                            <span class="info-value" id="infoWifiRSSI">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">MAC Address:</span>
                            <span class="info-value" id="infoWifiMAC">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Pixel Count:</span>
                            <span class="info-value" id="infoLighterNumber">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Data Pin:</span>
                            <span class="info-value" id="infoLighterPin">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Version:</span>
                            <span class="info-value" id="infoSystemVersion">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Uptime:</span>
                            <span class="info-value" id="infoSystemUptime">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Location:</span>
                            <span class="info-value" id="infoLocationCity">-</span>
                        </div>
                    </div>
                </section>


                <section class="card visualization-card">
                    <h2>Light Visualization</h2>
                    <div id="lightVisualization" class="light-visualization">

                    </div>
                </section>

            </div>


            <div class="column">


                <section class="card debug-card">
                    <h2>DEBUG Mode</h2>
                    <p class="debug-info">Control individual pixels for testing</p>

                    <div class="form-group">
                        <label for="debugPixelIndex">Select Pixel:</label>
                        <select id="debugPixelIndex" disabled>
                            <option value="0">Pixel 0</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="debugColor">Color:</label>
                        <input type="color" id="debugColor" value="#FF0000" disabled>
                        <input type="text" id="debugColorHex" value="#FF0000" disabled>
                    </div>

                    <div class="form-group">
                        <label for="debugBrightness">Brightness: <span id="brightnessValue">255</span></label>
                        <input type="range" id="debugBrightness" min="0" max="255" value="255" disabled>
                    </div>

                    <div class="button-group">
                        <button id="applyDebugBtn" class="btn btn-primary" disabled>Apply</button>
                        <button id="clearDebugBtn" class="btn btn-warning" disabled>Clear DEBUG</button>
                    </div>

                    <div class="debug-status">
                        <span id="debugStatus">DEBUG Inactive</span>
                    </div>
                </section>


                <!-- MAX9814 Audio Monitor -->
                <section class="card audio-monitor-card">
                    <h2>üé§ MAX9814 Audio Monitor</h2>
                    <p class="audio-info">Real-time microphone status</p>

                    <div class="audio-stats">
                        <div class="stat-item">
                            <span class="stat-label">Raw ADC:</span>
                            <span class="stat-value" id="audioRawADC">--</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Volume:</span>
                            <span class="stat-value" id="audioVolume">-- dB</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">VU Level:</span>
                            <span class="stat-value" id="audioVULevel">-- / 7</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Status:</span>
                            <span class="stat-value" id="audioStatus">‚ö™ Waiting...</span>
                        </div>
                    </div>

                    <div class="volume-bar-container">
                        <label>Volume Bar:</label>
                        <div class="volume-bar">
                            <div class="volume-bar-fill" id="volumeBarFill" style="width: 0%"></div>
                        </div>
                        <div class="volume-range">
                            <span id="minDbLabel">30 dB</span>
                            <span id="maxDbLabel">120 dB</span>
                        </div>
                    </div>

                    <div class="spectrum-preview">
                        <label>Virtual Spectrum (12 Bands):</label>
                        <div class="spectrum-bars" id="spectrumBars">
                            <!-- Â∞ÜÁî± JS ÁîüÊàê 12 ‰∏™È¢ëÊÆµÊü± -->
                        </div>
                    </div>
                </section>


                <section class="card log-card">
                    <h2>MQTT Messages</h2>
                    <div class="log-controls">
                        <button id="clearLogBtn" class="btn btn-sm">Clear</button>
                        <label>
                            <input type="checkbox" id="autoScrollLog" checked>
                            Auto-scroll
                        </label>
                    </div>
                    <div id="mqttLog" class="mqtt-log"></div>
                </section>

            </div>

        </div>


        <footer class="dashboard-footer">
            <p>Aura Light Dashboard V2.0 | CASA0014 Coursework |
                <a href="https://github.com/yourusername/aura-light" target="_blank">GitHub</a>
            </p>
        </footer>

    </div>


    <script src="https://unpkg.com/mqtt@5.3.4/dist/mqtt.min.js"></script>
    <script type="module" src="js/app.js"></script>
</body>

</html>